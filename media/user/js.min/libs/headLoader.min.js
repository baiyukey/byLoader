/**
 * headLoader用于加载、预加载及缓存网站资源，实现网站快速响应，优化服务器请求的目的。使用纯前端技术，基本上用"0成本"就能使普通的网站得到明显的加速效果。
 * @global : headLoader
 * @author: 宇哥 baiyukey@qq.com
 * @param {String} [this.dataDir] -资源路径
 * @param {Array} [this.dataCss] -CSS模块列表
 * @param {Array} [this.dataJs] -JS资源路径
 * @param {Number} [this.dataLifecycle] -缓存生成周期，单位小时，默认2
 * @param {Number} [this.preload] -预加载开关 1:预加载打开(不应用于当前页面)，0:预加载关闭（加载后立即应用于当前页面）。 默认0 。
 * @param {Boolean} [this.dataElfFrame] -是否在elfFrame框架下
 * @param {Function} [this.callback] -所有资源加载完成后的回调函数
 * @param {Boolean} [this.showLog] -是否显示加载统计
 * @link : https://github.com/baiyukey/headLoader
 * @version : 1.0.4
 * @copyright : http://www.uielf.com
 */
var headLoader=void 0;!function(e){var t=/^((192\.168|172\.([1][6-9]|[2]\d|3[01]))(\.([2][0-4]\d|[2][5][0-5]|[01]?\d?\d)){2}|10(\.([2][0-4]\d|[2][5][0-5]|[01]?\d?\d)){3})|(localhost)$/.test(e.location.hostname)?"":".min";headLoader=function(a){var n=a||{};this.dataDir=n.dataDir||"",this.dataCss=n.dataCss||[],this.dataJs=n.dataJs||[],this.dataLifecycle=n.dataLifecycle||l,this.dataElfFrame=n.dataElfFrame||c,this.callback=n.callback||null,this.multiLoad=n.multiLoad||".min"===t,this.showLog=n.showLog||!1,this.preload=void 0!==n.preload?n.preload:0;var o=this,i=function(e){return 0===e.indexOf("http://")||0===e.indexOf("https://")},r=function(e){var a=new Date,n=e||2;return n=Math.min(24,n),""===t?""+a.getTime():""+(a.getMonth()+1)+a.getDate()+Math.ceil((a.getHours()+1)/n)},p=function(e){for(var t=[],a="",n=0;n<e.length;n++)0!==(a=e[n].replace(/^(\s*)|(\s*)$/g,"")).length&&t.indexOf(a)<0&&t.push(a);return t},f=function(e,t){t.length>0&&t.forEach(function(t){e.setAttribute(t.split("=")[0],t.split("=")[1])})};void 0===e.headLoaderCache&&(e.headLoaderCache={});var m=function(t,a){var n,o;n=H.encode(t),o=a,e.headLoaderCache[n]=o,e.localStorage.setItem(n,o)},J=function(t){return a=H.encode(t),e.headLoaderCache[a]||(e.headLoaderCache[a]=e.localStorage.getItem(a)),e.headLoaderCache[a];var a},U=function(e,a){return o.dataElfFrame?(""+o.dataDir+a+t+"/"+e.split("|")[0]).replace("."+a,"")+t+"."+a:""+o.dataDir+e.split("|")[0]+"."+a},v=function(e,a){return((o.dataDir+a+t+"/"+e.split("|")[0]).replace("."+a,"")+t).replace(/\./g,"_")},T=function(e,t){if(i(e))return E(e),"function"==typeof t&&t(),!1;var a=U(e,"js")+"?v="+s,n=v(e,"js"),o=void 0,r=J(n),c=J(n+"_version");null===r||c!==s?(window.XMLHttpRequest?o=new XMLHttpRequest:window.ActiveXObject&&(o=new ActiveXObject("Microsoft.XMLHTTP")),void 0!==o&&(o.open("GET",a),o.send(null),o.onreadystatechange=function(){4===Number(o.readyState)&&200===Number(o.status)&&(r=o.responseText,m(n,r=null===r?"":r),m(n+"_version",s),u++,"function"==typeof t&&t())})):"function"==typeof t&&t()},y=function(e,t){if(i(e))return w(e),"function"==typeof t&&t(),!1;var a=U(e,"css")+"?v="+s,n=v(e,"css"),r=void 0,c=J(n),l=J(n+"_version");null===c||l!==s?(window.XMLHttpRequest?r=new XMLHttpRequest:window.ActiveXObject&&(r=new ActiveXObject("Microsoft.XMLHTTP")),void 0!==r&&(r.open("GET",a),r.send(null),r.onreadystatechange=function(){4===Number(r.readyState)&&200===Number(r.status)&&(c=(c=(c=null===(c=r.responseText)?"":c).replace(/\[dataDir]/g,o.dataDir)).replace(/\[v]/g,d),m(n,c),m(n+"_version",s),u++,"function"==typeof t&&t())})):"function"==typeof t&&t()},L=function(e,a){if(""!==t)return Function(a)(),!1;var n=document.getElementsByTagName("HEAD").item(0),o=document.createElement("script");f(o,e.split("|").splice(1)),o.setAttribute("type","text/javascript"),o.setAttribute("data-name",e.split("|")[0].replace(".js","")+t),o.innerHTML=a,n.appendChild(o)},b=function(e,a){if(0===document.getElementsByTagName("HEAD").length)return!1;var n=document.getElementsByTagName("HEAD").item(0),i=void 0;if(o.multiLoad&&(i=document.getElementsByTagName("style").item(0)))return i.innerHTML+=a,!1;i=document.createElement("style"),f(i,e.split("|").splice(1)),i.setAttribute("type","text/css"),i.setAttribute("data-name",e.split("|")[0].replace(".css","")+t),i.innerHTML=a,n.appendChild(i)},E=function(e){if(0===document.getElementsByTagName("HEAD").length)return!1;var a=document.getElementsByTagName("HEAD").item(0),n=document.createElement("script");f(n,e.split("|").splice(1)),n.src=0===e.indexOf("http")?e.split("|")[0]:e.split("|")[0].replace(".js","")+t+".js?"+s,a.appendChild(n)},w=function(e){if(0===document.getElementsByTagName("HEAD").length)return!1;var a=document.getElementsByTagName("HEAD").item(0),n=document.createElement("link");f(n,e.split("|").splice(1)),n.type="text/css",n.rel="stylesheet",n.media="screen",n.href=0===e.indexOf("http")?e.split("|")[0]:e.split("|")[0].replace(".css","")+t+".css?"+s,a.appendChild(n)},A=function(e,a){var n=void 0,i={JS:L,CSS:b}[a.toUpperCase()],r=e.map(function(e){return n=(o.dataDir+a+t+"/"+e.replace(/(\.js)|(\.css)/g,"")+t).replace(/\./g,"_"),J(n)}).join("js"===a?";":" ");i(1===e.length?e[0]:a+"_"+s,r)},C=function(e,t,a){if(0===document.getElementsByTagName("HEAD").length)return!1;if(!e||0===e.length)return"function"==typeof a&&a.call(!1),!1;var n={JS:T,CSS:y}[t.toUpperCase()];(o.multiLoad?function(){if(!e||0===e.length)return"function"==typeof a&&a.call(!1),!1;var i=new Array(e.length).fill(0).map(function(t,a){return new Promise(function(t){n(e[a],function(){return t("success")})})});Promise.all(i).then(function(){0!==e.length&&0===o.preload&&A(e,t),"function"==typeof a&&a.call(!1)})}:function(){var i=0;!function r(){i>=e.length?"function"==typeof a&&a.call(!1):n(e[i],function(){0===o.preload&&A([e[i]],t),i++,r()})}()})()},H=new function(){for(var e="",t=48;t<=122;t++)t>=58&&t<=64||t>=91&&t<=96||(e+=String.fromCharCode(t));var a=(e=(e=e.replace(/[aeiouAEIOU01]/g,"")).slice(0,18)+"$-_+!*"+e.slice(18)).length,n=location.host.length,o=-1,i="",r="";this.encode=function(t){i=encodeURIComponent(t).replace(/\./g,"&dot"),r="",o=-1;for(var c=0;c<i.length;c++)o=e.indexOf(i.charAt(c)),r+=o<0?i.charAt(c):e.charAt((o+n)%a);return r}};this.run=function(){o.dataCss=p(o.dataCss.join(",").replace(/_css/g,g).split(",")),o.dataJs=p(o.dataJs.join(",").replace(/_js/g,g).split(",")),s=r(l),d=r(24);var t=function(){var t;o.showLog&&(t=(new Date).getTime()-h,e.headLoaderHistory=void 0!==e.headLoaderHistory?e.headLoaderHistory:[],void 0!==e.showLogTimeout&&clearTimeout(e.showLogTimeout),e.showLogTimeout=setTimeout(function(){u>0&&(e.headLoaderHistory=e.headLoaderHistory.concat(new Array(u-1).fill(0),t));var a=0,n=0;e.headLoaderHistory.length>0&&(a=e.headLoaderHistory.reduce(function(e,t){return e+t}),n=Math.ceil(a/e.headLoaderHistory.length)),console.log("当前页面使用headLoader"+(o.multiLoad?"并行":"串行")+"网络请求%c"+u+"个%cJS/CSS文件，程序用时%c"+t+"毫秒%c，累计网络请求%c"+e.headLoaderHistory.length+"个%cJS/CSS文件，单文件平均用时%c"+n+"毫秒","color:#1b8884","","color:#1b8884","","color:#1b8884","","color:#1b8884","")},3e3)),"function"==typeof o.callback&&o.callback.call(!1)};C(o.dataCss,"css",function(){C(o.dataJs,"js",t)})}};for(var a=document.getElementsByTagName("script"),n=void 0,o=[],i=[],r=void 0,c=!1,l=2,s="",d="",u=0,h=(new Date).getTime(),p=0;p<a.length;p++)if(a[p].hasAttribute("src")&&a[p].getAttribute("src").indexOf(atob("aGVhZExvYWRlci4="))>=0){n=a.item(p);break}if(!n)return console.log&&console.log("%c"+decodeURIComponent(atob("JUU5JTk0JTk5JUU4JUFGJUFGJUU2JThGJTkwJUU3JUE0JUJBJTNBJUU3JUE4JThCJUU1JUJBJThGJUU2JTlDJUFBJUU2JTg4JTkwJUU1JThBJTlGJUU2JTg5JUE3JUU4JUExJThDJTJDJUU2JThGJTkyJUU0JUJCJUI2JUU1JTkwJThEJUU3JUE3JUIwJUU0JUI4JUJBaGVhZExvYWRlci5qcyVFNiU4OCU5NiVFOCU4MCU4NWhlYWRMb2FkZXIubWluLmpzJUU2JUIzJUE4JUU2JTg0JThGJUU1JUE0JUE3JUU1JUIwJThGJUU1JTg2JTk5LiVFNSVBNiU4MiVFNiU5QyU4OSVFNyU5NiU5MSVFOSU5NyVBRSVFOCVBRiVCNyVFOCVBRSVCRiVFOSU5NyVBRSUzQWh0dHBzJTNBJTJGJTJGZ2l0aHViLmNvbSUyRmJhaXl1a2V5JTJGaGVhZExvYWRlcg==")),"color:#F00"),!1;var f=console.log&&".min"!==t,m="static"===location.pathname.split("/")[1]?"/static":"/",g=location.pathname.replace(m,"").replace(".html","");""===location.pathname.replace(/.*\//,"").replace(".html","")&&(g+="index"),g=0===g.indexOf("/")?g.substr(1):g,n.hasAttribute("data-elfFrame")?c=["true",""].includes(n.getAttribute("data-elfFrame")):f&&console.log('%c友情提示:script标签未设置"data-elfFrame"属性,默认为false.',"color:#69F;"),n.hasAttribute("data-lifecycle")?l=Number(n.getAttribute("data-lifecycle")):f&&console.log('%c友情提示:script标签未设置"data-lifecycle"属性,默认为'+l+"小时.","color:#69F;"),n.hasAttribute("data-dir")?r=n.getAttribute("data-dir"):f&&console.log('%c友情提示:script标签未设置"data-dir"属性.',"color:#69F;"),n.hasAttribute("data-css")?i=n.getAttribute("data-css").split(","):f&&console.log('%c友情提示:script标签未设置"data-css"属性',"color:#69F;"),n.hasAttribute("data-js")?o=n.getAttribute("data-js").split(","):f&&console.log('%c友情提示:script标签未设置"data-js"属性',"color:#69F;"),a.length>0&&""!==t&&a.item(0).remove();var J=new headLoader;r&&(J.dataDir=r),J.dataCss=i,J.dataJs=o,J.dataLifecycle=l,J.run()}(window.location.origin===window.top.location.origin?window.top:window);
