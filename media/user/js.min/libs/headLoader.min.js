/**
 * @link : https://github.com/baiyukey/headLoader
 * @version : 2.0.96
 * @copyright : http://www.uielf.com
 */
function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function a(o,i){try{var s=t[o](i),l=s.value}catch(e){return void n(e)}if(!s.done)return Promise.resolve(l).then(function(e){a("next",e)},function(e){a("throw",e)});e(l)}("next")})}}let headLoader,localDB;!function(e){if(!e.Promise)return e.onload=function(){document.body.innerHTML='<div style="text-align:center"><ul style="display:inline-block;margin-top:20px;text-align:left;list-style:none;line-height:32px;"><li style="list-style:none;"><h3>抱歉，您的浏览器不支持运行当前页面！</h3>如下两种方法供您参考：</li><li>✱ 请将您的浏览器切换到 "极速内核" (如果有)。</li><li>✱ <a href="https://www.google.cn/chrome/">或者下载安装 "chrome" 浏览器后重试。</a></li></ul></div>'};let t=e.XMLHttpRequest,n=/^((192\.168|172\.([1][6-9]|[2]\d|3[01]))(\.([2][0-4]\d|[2][5][0-5]|[01]?\d?\d)){2}|10(\.([2][0-4]\d|[2][5][0-5]|[01]?\d?\d)){3})|(localhost)$/.test(e.location.hostname)?"":".min",a=function(e){let t=(new Date).getTime()+288e5,n=e>0?36e5*e:1;return String(new Date(t-t%n+n).getTime()-288e5)},o=new function(){let e="";for(let t=48;t<=122;t++)t>=58&&t<=64||t>=91&&t<=96||(e+=String.fromCharCode(t));let t=(e=(e=e.replace(/[aeiouAEIOU01]/g,"")).slice(0,18)+"$-_+!*"+e.slice(18)).length,n=location.host.length,a=-1,o="",i="";this.encode=function(s){o=encodeURIComponent(s).replace(/\./g,"&dot"),i="",a=-1;for(let s=0;s<o.length;s++)a=e.indexOf(o.charAt(s)),i+=a<0?o.charAt(s):e.charAt((a+n)%t);return i}};localDB=function(t){let i={database:"localDB",tables:{data:["key","value","version"]},version:a(".min"===n?24:0)};Object.assign(i,t),e.localDBResult=e.localDBResult||null,e.localDBStatus=e.localDBStatus||0;const s=function(){return void 0!==e.waitCloseLocalDB&&clearTimeout(e.waitCloseLocalDB),new Promise((t,n)=>{if(null!==e.localDBResult&&1===e.localDBStatus)return void t("success");let a=e.indexedDB.open(i.database);a.onerror=function(e){n(e)},a.onsuccess=function(n){e.localDBResult=a.result,e.localDBStatus=1,t(n)},a.onupgradeneeded=function(n){e.localDBResult=n.target.result,e.localDBStatus=1;let a=Object.keys(i.tables);for(const t of a)if(!e.localDBResult.objectStoreNames.contains(t)){let n=e.localDBResult.createObjectStore(t,{keyPath:"key"});i.tables[t].forEach(e=>n.createIndex(e,["key"],{unique:!0}))}n.target.transaction.oncomplete=(()=>t(e.localDBResult))}})},l=function(t){return void 0!==e.waitCloseLocalDB&&clearTimeout(e.waitCloseLocalDB),new Promise((n,a)=>{e.waitCloseLocalDB=setTimeout(function(){0!==e.localDBStatus?(null!==e.localDBResult&&e.localDBResult.close(),e.localDBStatus=0,n("success")):n("success")},t||3e3)})},r=(c=_asyncToGenerator(function*(){if(!e.localDBResult)return console.warn(`目前还没有库${i.database}`);yield l(0),e.indexedDB.deleteDatabase(i.database),g&&console.log(`${i.database}已删除`)}),function(){return c.apply(this,arguments)});var c;const u=function(){let t={tableName:"data",key:"",value:null,etag:""};return"object"==typeof arguments[0]?Object.assign(t,arguments[0]):(t.key=arguments[0]||t.key,t.value=arguments[1]||t.value,t.tableName=arguments[2]||t.tableName),new Promise((a=_asyncToGenerator(function*(a,l){yield s();let r={key:".min"===n?o.encode(t.key):t.key,value:t.value,etag:t.etag,version:i.version},c="add";yield d(t.key,"data").then(function(e){c=e?"put":"add"}).catch(function(e){c="add"});let u=e.localDBResult.transaction(t.tableName,"readwrite").objectStore(t.tableName)[c](r);u.onsuccess=function(){a(r)},u.onerror=function(e){return l(e)}}),function(e,t){return a.apply(this,arguments)}));var a},d=function(t,a){return new Promise((i=_asyncToGenerator(function*(i,l){let r={},c=(u=_asyncToGenerator(function*(){yield s();let c=a||"data",u=e.localDBResult.transaction(c,"readonly").objectStore(c).index("key"),d=".min"===n?o.encode(t):t,h=u.get(IDBKeyRange.only([d]));h.onsuccess=function(e){(r=e.target.result)&&Object.assign(r,{key:t}),i(r)},h.onerror=function(e){return l(e)}}),function(){return u.apply(this,arguments)});var u;if(r=h.temp[t])return i(r),!0;yield c()}),function(e,t){return i.apply(this,arguments)}));var i};(function(){return!!(e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.msIndexedDB)||(console&&console.log("您的浏览器不支持indexedDB，请使用现代浏览器，例如chrome,firefox等."),!1)})&&(this.open=s,this.close=l,this.delete=r,this.setItem=u,this.getItem=d,this.temp={});let h=this},headLoader=function(o){let i=o||{};this.dataDir=i.dataDir||"",this.dataCss=i.dataCss||[],this.dataJs=i.dataJs||[],this.dataFont=i.dataFont||[],this.dataHtml=i.dataHtml||[],this.dataLifecycle=i.dataLifecycle||l,this.dataActive=i.dataActive||f,this.callback=i.callback||null,this.multiLoad=i.multiLoad||".min"===n,this.showLog=i.showLog||!1,this.preload=void 0!==i.preload?i.preload:0,this.requestVersion="",this.db={temp:{}};let s=function(e,t){let n=[],a="";for(let o=0;o<e.length;o++)0!==(a=e[o].replace(/^(\s*)|(\s*)$/g,"").replace(new RegExp(`(.${t})$`),"")).length&&n.indexOf(a)<0&&n.push(a);return n},r=function(e,t){t.length>0&&t.forEach(function(t){e.setAttribute(t.split("=")[0],t.split("=")[1])})};void 0===e.headLoaderCache&&(e.headLoaderCache={});let c=function(e,t,a){return B.dataActive&&["js","css"].includes(t)?`${B.dataDir}${t}${n}/${e.split("|")[0]}`.replace("."+(a||t),"")+n+"."+(a||t):`${B.dataDir}${e.split("|")[0]}.${a||t}`},u=function(e,t){return["js","css"].includes(t)?(B.dataDir+t+n+"/"+e.split("|")[0]).replace("."+t,"")+n+"."+t:B.dataDir+e.split("|")[0]+"."+t},d=function(e,n){return new Promise((o,i)=>{if(!e)return o(2);e.version!==B.requestVersion?""===e.etag?o(2):(a=n,new Promise((e,n)=>{let o=new t;o.open("HEAD",a,!0),o.send(),o.onreadystatechange=function(){4===Number(o.readyState)&&200===Number(o.status)&&e(o.getResponseHeader("etag")||o.getResponseHeader("last-modified")||"")},o.onerror=(e=>n(e))})).then(t=>{e.etag===t?o(1):o(2)}).catch(e=>i(e)):o(0)});var a},h=function(e,n){return new Promise(o=>{if((e=>0===e.indexOf("http://")||0===e.indexOf("https://"))(e))return"js"===n?U(e):"css"===n&&T(e),o("success");let i=c(e,n)+"?v="+B.requestVersion,s=u(e,n),l=(a=_asyncToGenerator(function*(e,a){let l={};if(Object.assign(l,{key:s,value:a?a.value:"",etag:a?a.etag:"",version:a?a.version:B.requestVersion}),0===e)B.db.temp[s]=l,o("success");else if(1===e)B.db.temp[s]=l,o("success"),B.db.setItem(l);else if(2===e){let e=new t;e.open("GET",i,!0),e.send(),e.onreadystatechange=_asyncToGenerator(function*(){if(4===Number(e.readyState)&&200===Number(e.status)){let t=e.responseText||"";"css"===n&&(t=t.replace(/\[v]/g,B.requestVersion)),Object.assign(l,{value:t,etag:e.getResponseHeader("etag")||e.getResponseHeader("last-modified")||""}),B.showLog&&m++,B.db.temp[s]=l,o("success"),B.db.setItem(l)}})}}),function(e,t){return a.apply(this,arguments)});B.db.getItem(s).then(e=>{d(e,i).then(t=>l(t,e)).catch(e=>console.error(e))})});var a},g=function(e){return new Promise((t=_asyncToGenerator(function*(t){let n=u(e,"woff"),a=c(e,"fonts","woff")+"?v="+B.requestVersion;if("function"!=typeof FontFace)return new Promise(function(e,t){return t("failed")});const o=new FontFace("elfRound","url("+a+")");yield o.load(),document.fonts.add(o),t({key:n,value:o})}),function(e){return t.apply(this,arguments)}));var t},J=function(e,t){if(""!==n)return Function(t)(),!1;let a=document.getElementsByTagName("HEAD").item(0),o=document.createElement("script");r(o,e.split("|").splice(1)),o.setAttribute("type","text/javascript"),o.setAttribute("data-name",e.split("|")[0].replace(".js","")+n),o.innerHTML=t,a.appendChild(o)},b=function(e,t){if(0===document.getElementsByTagName("HEAD").length)return!1;let a,o=document.getElementsByTagName("HEAD").item(0);if(B.multiLoad&&(a=document.getElementsByTagName("style").item(0)))return a.innerHTML+=t,!1;a=document.createElement("style"),r(a,e.split("|").splice(1)),a.setAttribute("type","text/css"),a.setAttribute("data-name",e.split("|")[0].replace(".css","")+n),a.innerHTML=t,o.appendChild(a)},U=function(e){if(0===document.getElementsByTagName("HEAD").length)return!1;let t=document.getElementsByTagName("HEAD").item(0),a=document.createElement("script");r(a,e.split("|").splice(1)),a.src=0===e.indexOf("http")?e.split("|")[0]:e.split("|")[0].replace(".js","")+n+".js?v="+B.requestVersion,t.appendChild(a)},T=function(e){if(0===document.getElementsByTagName("HEAD").length)return!1;let t=document.getElementsByTagName("HEAD").item(0),a=document.createElement("link");r(a,e.split("|").splice(1)),a.type="text/css",a.rel="stylesheet",a.media="screen",a.href=0===e.indexOf("http")?e.split("|")[0]:e.split("|")[0].replace(".css","")+n+".css?v="+B.requestVersion,t.appendChild(a)},w=(v=_asyncToGenerator(function*(e,t){return 1===B.preload||new Promise(function(n,a){let o,i={JS:J,CSS:b}[t.toUpperCase()];if(!i)return n("页面写入仅支持js、css.");let s={},l=[];e.forEach(function(e){s[e]="";l.push(new Promise(function(n,a){o=u(e,t),s[e]=B.db.temp[o]?B.db.temp[o].value:"",n("success")}))}),Promise.all(l).then(function(){i(1===e.length?e[0]:t+"_"+B.requestVersion,Object.values(s).join("js"===t?";":" ")),n("success")}).catch(function(e){return a(e)})})}),function(e,t){return v.apply(this,arguments)});var v;let D=function(e,t){if(0===document.getElementsByTagName("HEAD").length)return!1;if(!e||0===e.length)return new Promise(e=>e("success"));let n={JS:h,CSS:h,FONT:g,HTML:h}[t.toUpperCase()],a=(o=_asyncToGenerator(function*(a){let o=0,i=(s=_asyncToGenerator(function*(){if(o>=e.length)return!0;yield n(e[o],t),yield w([e[o]],t),yield i(o++)}),function(){return s.apply(this,arguments)});var s;yield i(),a("success")}),function(e){return o.apply(this,arguments)});var o;return new Promise(B.multiLoad?function(a){let o=new Array(e.length).fill(0).map((a,o)=>new Promise((i=_asyncToGenerator(function*(a){yield n(e[o],t),a("success")}),function(e){return i.apply(this,arguments)})));var i,s;Promise.all(o).then((s=_asyncToGenerator(function*(n){yield w(e,t),a("success")}),function(e){return s.apply(this,arguments)}))}:a)};this.requestVersion=a(this.dataLifecycle&&this.dataLifecycle>0?this.dataLifecycle:".min"===n?2:0),this.db=new localDB({version:this.requestVersion}),this.run=function(){B.dataCss=s(B.dataCss.join(",").replace(/_css/g,y).split(","),"css"),B.dataJs=s(B.dataJs.join(",").replace(/_js/g,y).split(","),"js"),B.dataFont=s(B.dataFont,""),B.dataHtml=s(B.dataHtml,"html"),_asyncToGenerator(function*(){yield B.db.open(),yield D(B.dataCss,"css"),yield D(B.dataFont,"font"),yield D(B.dataJs,"js"),yield D(B.dataHtml,"html"),B.showLog&&function(){let t=(new Date).getTime()-p;e.headLoaderHistory=void 0!==e.headLoaderHistory?e.headLoaderHistory:[],void 0!==e.showLogTimeout&&clearTimeout(e.showLogTimeout),e.showLogTimeout=setTimeout(()=>{m>0&&(e.headLoaderHistory=e.headLoaderHistory.concat(new Array(m-1).fill(0),t));let n=0,a=0;e.headLoaderHistory.length>0&&(n=e.headLoaderHistory.reduce((e,t)=>e+t),a=Math.ceil(n/e.headLoaderHistory.length)),console.log("当前页面使用headLoader"+(B.multiLoad?"并行":"串行")+"网络请求%c"+m+"个%cJS/CSS文件，程序用时%c"+t+"毫秒%c，累计网络请求%c"+e.headLoaderHistory.length+"个%cJS/CSS文件，单文件平均用时%c"+a+"毫秒","color:#1b8884","","color:#1b8884","","color:#1b8884","","color:#1b8884","")},3e3)}(),"function"==typeof B.callback&&B.callback.call(B,B.db.temp),yield B.db.close()})()};let B=this};let i,s,l,r=document.getElementsByTagName("script"),c=[],u=[],d=[],h=[],f=!1,m=1,p=(new Date).getTime();for(let e=0;e<r.length;e++)if(r[e].hasAttribute("src")&&r[e].getAttribute("src").indexOf(atob("aGVhZExvYWRlci4="))>=0){i=r.item(e);break}if(!i)return console.log&&console.log("%c"+decodeURIComponent(atob("JUU5JTk0JTk5JUU4JUFGJUFGJUU2JThGJTkwJUU3JUE0JUJBJTNBJUU3JUE4JThCJUU1JUJBJThGJUU2JTlDJUFBJUU2JTg4JTkwJUU1JThBJTlGJUU2JTg5JUE3JUU4JUExJThDJTJDJUU2JThGJTkyJUU0JUJCJUI2JUU1JTkwJThEJUU3JUE3JUIwJUU0JUI4JUJBaGVhZExvYWRlci5qcyVFNiU4OCU5NiVFOCU4MCU4NWhlYWRMb2FkZXIubWluLmpzJUU2JUIzJUE4JUU2JTg0JThGJUU1JUE0JUE3JUU1JUIwJThGJUU1JTg2JTk5LiVFNSVBNiU4MiVFNiU5QyU4OSVFNyU5NiU5MSVFOSU5NyVBRSVFOCVBRiVCNyVFOCVBRSVCRiVFOSU5NyVBRSUzQWh0dHBzJTNBJTJGJTJGZ2l0aHViLmNvbSUyRmJhaXl1a2V5JTJGaGVhZExvYWRlcg==")),"color:#F00"),!1;let g=console.log&&".min"!==n,y=location.pathname.replace(".html","");""===location.pathname.replace(/.*\//,"").replace(".html","")&&(y+="index"),y=0===y.indexOf("/")?y.substr(1):y,i.hasAttribute("data-active")?f=["true",""].includes(i.getAttribute("data-active")):g&&console.log('%c友情提示:script标签未设置"data-active"属性,默认为false.',"color:#69F;"),i.hasAttribute("data-lifecycle")?l=Number(i.getAttribute("data-lifecycle")):g&&console.log('%c友情提示:script标签未设置"data-lifecycle"属性,默认为0(开发环境)或24小时(线上环境）.',"color:#69F;"),i.hasAttribute("data-dir")?s=i.getAttribute("data-dir"):g&&console.log('%c友情提示:script标签未设置"data-dir"属性.',"color:#69F;"),i.hasAttribute("data-css")?u=i.getAttribute("data-css").split(","):g&&console.log('%c友情提示:script标签未设置"data-css"属性',"color:#69F;"),i.hasAttribute("data-js")?c=i.getAttribute("data-js").split(","):g&&console.log('%c友情提示:script标签未设置"data-js"属性',"color:#69F;"),i.hasAttribute("data-font")&&(d=i.getAttribute("data-font").split(",")),i.hasAttribute("data-html")?h=i.getAttribute("data-html").split(","):g&&console.log('%c友情提示:script标签未设置"data-js"属性',"color:#69F;"),r.length>0&&""!==n&&r.item(0).remove();let J=new headLoader;s&&(J.dataDir=s),J.dataCss=u,J.dataJs=c,J.dataFont=d,J.dataHtml=h,J.dataLifecycle=l,J.showLog=!1,J.run()}("null"===window.location.origin||window.location.origin===window.top.location.origin?window.top:window);
